<!DOCTYPE HTML>
<html>
<head >
  <meta charset="utf-8">
  
  <title>第 5 页 | zeven&#39;s blog</title>

  
  <meta name="author" content="zeven0707&#39;s blog">
  

  

  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  

  <meta property="og:site_name" content="zeven&#39;s blog"/>

  
  <meta property="og:image" content="/favicon.ico"/>
  
  
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-5005349780815724",
    enable_page_level_ads: true
  });
</script>

  
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?223eea22355699157e147870eb124b24";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>


  <link rel="manifest" href="/manifest.json">
  <link href="/favicon.ico" rel="icon">

  <link rel="alternate" href="/atom.xml" title="zeven&#39;s blog" type="application/atom+xml">
  <link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/base/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">


</head>


<body>
<div class="blog">
  <div class="content">

    

    <header class="header-container" style="background-image: url('/images/blog-bg.jpg');">


<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <div class="navbar-header page-scroll">
          <button type="button" id="tglBtn" class="navbar-toggle">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">zeven0707&#39;s blog</a>
        </div>
        <div id="bosenyblog-navbar">
          <div class="navbar-collapse" id="bs-example-navbar-collapse-6">
            <ul class="nav navbar-nav navbar-right">
            
              <li><a href="/">主页</a></li>
            
              <li><a href="/archives">日志</a></li>
            
              <li><a href="/about">关于</a></li>
            
              <li><a href="/tags">标签</a></li>
            
            </ul>
          </div>
        </div>

    </div>
 </nav>
 <div class="gotop-btn">

 </div>
</header>

        
        <div class="container ">
          <div class="row">
            <main class="site-main posts-loop    col-lg-8 col-lg-offset-1
                    col-md-8 col-md-offset-1
                    col-sm-12
                    col-xs-12">
            
  <article class="article-container ">

  
    
    <h3 class="article-title"><a href="/2019/09/21/oracle远程漏洞投毒扫描工具Metasploit/"><span>[Oracle] oracle远程漏洞投毒扫描工具</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2019/09/21/oracle远程漏洞投毒扫描工具Metasploit/" rel="bookmark">
        <time class="entry-date published" datetime="2019-09-21T14:43:00.000Z">
          2019-09-21
        </time>
      </a>
    </span>
    <br />
    
  </div>


  

  <div class="article-content">
    <div class="entry">
      
          <h1 id="1、安装扫描工具"><a href="#1、安装扫描工具" class="headerlink" title="1、安装扫描工具"></a>1、安装扫描工具</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">curl https://raw.githubusercontent.com/rapid7/metasploit-omnibus/master/config/templates/metasploit-framework-wrappers/msfupdate.erb &gt; msfinstall &amp;&amp; \</span><br><span class="line">chmod 755 msfinstall &amp;&amp; \</span><br><span class="line">./msfinstall</span><br></pre></td></tr></table></figure>

<h1 id="2、扫描相应的数据库"><a href="#2、扫描相应的数据库" class="headerlink" title="2、扫描相应的数据库"></a>2、扫描相应的数据库</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">[root@node3 soft]# msfconsole</span><br><span class="line">[-] ***rting the Metasploit Framework console...|</span><br><span class="line">[-] * WARNING: No database support: No database YAML file</span><br><span class="line">[-] ***</span><br><span class="line">      .:okOOOkdc'           'cdkOOOko:.</span><br><span class="line">    .xOOOOOOOOOOOOc       cOOOOOOOOOOOOx.</span><br><span class="line">   :OOOOOOOOOOOOOOOk,   ,kOOOOOOOOOOOOOOO:</span><br><span class="line">  'OOOOOOOOOkkkkOOOOO: :OOOOOOOOOOOOOOOOOO'</span><br><span class="line">  oOOOOOOOO.    .oOOOOoOOOOl.    ,OOOOOOOOo</span><br><span class="line">  dOOOOOOOO.      .cOOOOOc.      ,OOOOOOOOx</span><br><span class="line">  lOOOOOOOO.         ;d;         ,OOOOOOOOl</span><br><span class="line">  .OOOOOOOO.   .;           ;    ,OOOOOOOO.</span><br><span class="line">   cOOOOOOO.   .OOc.     'oOO.   ,OOOOOOOc</span><br><span class="line">    oOOOOOO.   .OOOO.   :OOOO.   ,OOOOOOo</span><br><span class="line">     lOOOOO.   .OOOO.   :OOOO.   ,OOOOOl</span><br><span class="line">      ;OOOO'   .OOOO.   :OOOO.   ;OOOO;</span><br><span class="line">       .dOOo   .OOOOocccxOOOO.   xOOd.</span><br><span class="line">         ,kOl  .OOOOOOOOOOOOO. .dOk,</span><br><span class="line">           :kk;.OOOOOOOOOOOOO.cOk:</span><br><span class="line">             ;kOOOOOOOOOOOOOOOk:</span><br><span class="line">               ,xOOOOOOOOOOOx,</span><br><span class="line">                 .lOOOOOOOl.</span><br><span class="line">                    ,dOd,</span><br><span class="line">                      .</span><br><span class="line"></span><br><span class="line">       =[ metasploit v5.0.27-dev-                         ]</span><br><span class="line">+ -- --=[ 1895 exploits - 1067 auxiliary - 329 post       ]</span><br><span class="line">+ -- --=[ 547 payloads - 44 encoders - 10 nops            ]</span><br><span class="line">+ -- --=[ 2 evasion                                       ]</span><br></pre></td></tr></table></figure>

<p>指定扫描数据库的ip地址</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">msf5 &gt;  use auxiliary&#x2F;scanner&#x2F;oracle&#x2F;tnspoison_checker</span><br><span class="line">msf5 auxiliary(scanner&#x2F;oracle&#x2F;tnspoison_checker) &gt; set rhosts 192.168.168.177</span><br><span class="line">rhosts &#x3D;&gt; 192.168.168.177</span><br></pre></td></tr></table></figure>

<p>查看配置选项</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">msf5 auxiliary(scanner&#x2F;oracle&#x2F;tnspoison_checker) &gt; show options</span><br><span class="line">Module options (auxiliary&#x2F;scanner&#x2F;oracle&#x2F;tnspoison_checker):</span><br><span class="line"></span><br><span class="line">   Name     Current Setting  Required  Description</span><br><span class="line">   ----     ---------------  --------  -----------</span><br><span class="line">   RHOSTS   192.168.168.177  yes       The target address range or CIDR identifier</span><br><span class="line">   RPORT    1521             yes       The target port (TCP)</span><br><span class="line">   THREADS  1                yes       The number of concurrent threads</span><br></pre></td></tr></table></figure>

<p>进行漏洞扫描</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">msf5 auxiliary(scanner&#x2F;oracle&#x2F;tnspoison_checker) &gt; run</span><br><span class="line">[+] 192.168.168.177:1521 - 192.168.168.177:1521 is vulnerable</span><br><span class="line">[*] 192.168.168.177:1521 - Scanned 1 of 1 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br></pre></td></tr></table></figure>

<p>根据提示177该服务器是易受攻击的，说明存在漏洞<br>下面是具体进行渗透测试：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">msf5 auxiliary(scanner&#x2F;oracle&#x2F;tnspoison_checker) &gt; use auxiliary&#x2F;admin&#x2F;oracle&#x2F;tnscmd</span><br><span class="line">msf5 auxiliary(admin&#x2F;oracle&#x2F;tnscmd) &gt; set rhosts 192.168.168.177</span><br><span class="line">rhosts &#x3D;&gt; 192.168.168.177</span><br><span class="line">msf5 auxiliary(admin&#x2F;oracle&#x2F;tnscmd) &gt; show options</span><br><span class="line">Module options (auxiliary&#x2F;admin&#x2F;oracle&#x2F;tnscmd):</span><br><span class="line"></span><br><span class="line">   Name    Current Setting                   Required  Description</span><br><span class="line">   ----    ---------------                   --------  -----------</span><br><span class="line">   CMD     (CONNECT_DATA&#x3D;(COMMAND&#x3D;VERSION))  no        Something like ping, version, status, etc..</span><br><span class="line">   RHOSTS  192.168.168.177                   yes       The target address range or CIDR identifier</span><br><span class="line">   RPORT   1521                              yes       The target port (TCP)</span><br><span class="line"></span><br><span class="line">msf5 auxiliary(admin&#x2F;oracle&#x2F;tnscmd) &gt; run</span><br><span class="line">[*] Running module against 192.168.168.177</span><br><span class="line"></span><br><span class="line">[*] 192.168.168.177:1521 - Sending &#39;(CONNECT_DATA&#x3D;(COMMAND&#x3D;VERSION))&#39; to 192.168.168.177:1521</span><br><span class="line">[*] 192.168.168.177:1521 - writing 90 bytes.</span><br><span class="line">[*] 192.168.168.177:1521 - reading</span><br><span class="line">[*] 192.168.168.177:1521 - .e......&quot;..Y(DESCRIPTION&#x3D;(TMP&#x3D;)(VSNNUM&#x3D;186647552)(ERR&#x3D;1189)(ERROR_STACK&#x3D;(ERROR&#x3D;(CODE&#x3D;1189)(EMFI&#x3D;4))))</span><br><span class="line">[*] Auxiliary module execution completed</span><br></pre></td></tr></table></figure>

<p>修改oracle服务端的监听配置文件listener.ora,增加下列内容<br>单实例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">VALID_NODE_CHECKING_REGISTRATION_LISTENER &#x3D;ON</span><br><span class="line">REGISTRATION_INVITED_NODES_LISTENER&#x3D;(192.168.168.177)</span><br></pre></td></tr></table></figure>

<p>多实例<br>listener.ora文件添加如下内容（RAC)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">VALID_NODE_CHECKING_REGISTRATION_LISTENER_SCAN*&#x3D;ON</span><br><span class="line">VALID_NODE_CHECKING_REGISTRATION_LISTENER_SCAN2&#x3D;ON</span><br><span class="line">VALID_NODE_CHECKING_REGISTRATION_LISTENER_SCAN1&#x3D;ON</span><br><span class="line">VALID_NODE_CHECKING_REGISTRATION_LISTENER &#x3D;ON</span><br><span class="line">REGISTRATION_INVITED_NODES_LISTENER&#x3D;(两台host的IP都列进来)</span><br></pre></td></tr></table></figure>

<p>重新加载监听</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsnrctl reload</span><br></pre></td></tr></table></figure>

<p>再次重新检测</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">msf5 auxiliary(admin&#x2F;oracle&#x2F;tnscmd) &gt; use auxiliary&#x2F;scanner&#x2F;oracle&#x2F;tnspoison_checker</span><br><span class="line">msf5 auxiliary(scanner&#x2F;oracle&#x2F;tnspoison_checker) &gt;  set rhosts 192.168.168.177</span><br><span class="line">rhosts &#x3D;&gt; 192.168.168.177</span><br><span class="line">msf5 auxiliary(scanner&#x2F;oracle&#x2F;tnspoison_checker) &gt; show options</span><br><span class="line"></span><br><span class="line">Module options (auxiliary&#x2F;scanner&#x2F;oracle&#x2F;tnspoison_checker):</span><br><span class="line"></span><br><span class="line">   Name     Current Setting  Required  Description</span><br><span class="line">   ----     ---------------  --------  -----------</span><br><span class="line">   RHOSTS   192.168.168.177  yes       The target address range or CIDR identifier</span><br><span class="line">   RPORT    1521             yes       The target port (TCP)</span><br><span class="line">   THREADS  1                yes       The number of concurrent threads</span><br><span class="line"></span><br><span class="line">msf5 auxiliary(scanner&#x2F;oracle&#x2F;tnspoison_checker) &gt; run</span><br><span class="line"></span><br><span class="line">[-] 192.168.168.177:1521 - 192.168.168.177:1521 is not vulnerable</span><br><span class="line">[*] 192.168.168.177:1521 - Scanned 1 of 1 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br></pre></td></tr></table></figure>


      
    </div>
    
  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/oracle/">oracle</a>
    </span>
    

    </div>

    
  </div>
  
    
    <h3 class="article-read"><a href="/2019/09/21/oracle远程漏洞投毒扫描工具Metasploit/"><span>点击阅读</span></a></h3>
    
  
</article>





  <article class="article-container ">

  
    
    <h3 class="article-title"><a href="/2019/09/21/oracle exp导出报错EXP-00091Exporting questionable statistics/"><span>[Oracle] oracle exp导出报错EXP-00091: Exporting questionable statistics</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2019/09/21/oracle exp导出报错EXP-00091Exporting questionable statistics/" rel="bookmark">
        <time class="entry-date published" datetime="2019-09-21T14:29:00.000Z">
          2019-09-21
        </time>
      </a>
    </span>
    <br />
    
  </div>


  

  <div class="article-content">
    <div class="entry">
      
          <h1 id="1、报错原因"><a href="#1、报错原因" class="headerlink" title="1、报错原因"></a>1、报错原因</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">数据库字符集与当前系统NLS_LANG参数不匹配</span><br></pre></td></tr></table></figure>

<h1 id="2、解决方法"><a href="#2、解决方法" class="headerlink" title="2、解决方法"></a>2、解决方法</h1><p>查看数据库的字符集</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> userenv(<span class="string">'language'</span>) <span class="keyword">from</span> dual;</span><br><span class="line">USERENV('LANGUAGE')</span><br><span class="line"><span class="comment">------------------------------------------------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">AMERICAN_AMERICA.ZHS16GBK</span><br></pre></td></tr></table></figure>

<p>声明NLS_LANG参数<br><code>export NLS_LANG=AMERICAN_AMERICA.ZHS16GBK</code><br>再次执行导出<br><code>exp \&quot;/ as sysdba \&quot; tables=sys.aud$ file=/tmp/cbi1_daochu.dmp</code></p>

      
    </div>
    
  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/oracle/">oracle</a>
    </span>
    

    </div>

    
  </div>
  
    
    <h3 class="article-read"><a href="/2019/09/21/oracle exp导出报错EXP-00091Exporting questionable statistics/"><span>点击阅读</span></a></h3>
    
  
</article>





  <article class="article-container ">

  
    
    <h3 class="article-title"><a href="/2019/09/21/oracle Cluster Verification Utility(cvu)参考/"><span>[Oracle]oracle Cluster Verification Utility(cvu)参考</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2019/09/21/oracle Cluster Verification Utility(cvu)参考/" rel="bookmark">
        <time class="entry-date published" datetime="2019-09-21T12:53:00.000Z">
          2019-09-21
        </time>
      </a>
    </span>
    <br />
    
  </div>


  

  <div class="article-content">
    <div class="entry">
      
          <h1 id="1、概述"><a href="#1、概述" class="headerlink" title="1、概述"></a>1、概述</h1><p>cvu工具用于数据库安装、补丁升级、其他系统变更等操作之前的系统检查。</p>
<h1 id="2、使用详情"><a href="#2、使用详情" class="headerlink" title="2、使用详情"></a>2、使用详情</h1><p>cvu包含两个脚本runcluvfy.sh和cluvfy.sh<br>runcluvfy.sh:用于安装GI和Database之前运行（位于grid安装包解压出来的目录下）<br>cluvfy.sh：用于GI安装完成之后，Database安装的系统检查（位于$GRID_HOME/bin目录下）</p>
<p>note*****使用runcluvfy脚本时建议添加-verbose参数来获取到详细的参数。</p>
<h1 id="3、使用下面语句检查预安装之前步骤是否完成"><a href="#3、使用下面语句检查预安装之前步骤是否完成" class="headerlink" title="3、使用下面语句检查预安装之前步骤是否完成"></a>3、使用下面语句检查预安装之前步骤是否完成</h1><p>一般使用方法<br>$ ./runcluvfy.sh stage -pre crsinst -fixup -n rac1,rac2 -verbose<br>指定一个修复文件的生成目录<br>./runcluvfy.sh stage -pre crsinst -fixup -fixupdir /tmp/fixit.sh -n rac1,rac2 -verbose<br>如果不指定版本，cvu会按照11.2的要求检查，指定版本按下面方法：<br>$ ./runcluvfy.sh stage -pre crsinst -n node1,node2,node3 -r 10gR2</p>

      
    </div>
    
  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/oracle/">oracle</a>
    </span>
    

    </div>

    
  </div>
  
    
    <h3 class="article-read"><a href="/2019/09/21/oracle Cluster Verification Utility(cvu)参考/"><span>点击阅读</span></a></h3>
    
  
</article>





  <article class="article-container ">

  
    
    <h3 class="article-title"><a href="/2019/09/21/oracle查询被锁的sql语句并解锁/"><span>[Oracle] oracle查询被锁的sql语句并解锁 </span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2019/09/21/oracle查询被锁的sql语句并解锁/" rel="bookmark">
        <time class="entry-date published" datetime="2019-09-21T09:25:00.000Z">
          2019-09-21
        </time>
      </a>
    </span>
    <br />
    
  </div>


  

  <div class="article-content">
    <div class="entry">
      
          <h1 id="实验1："><a href="#实验1：" class="headerlink" title="实验1："></a>实验1：</h1><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">session1：</span><br><span class="line">20:01:35 SYS@ boston&gt; select * from scott.t1 for update;</span><br><span class="line">session2：</span><br><span class="line">20:01:13 SCOTT@ boston&gt; update t1 set empno=8000 where empno=7566;</span><br></pre></td></tr></table></figure>

<p>session2执行update语句的时候卡主了，需要等待session1把锁释放掉。<br>session3查看当前被锁的会话：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">20:01:16 SYS@ boston&gt; select a.object_name,b.session_id,c.serial#,'alter system kill session '''||b.session_id||','||c.serial#||'''; ' as a,c.program,c.username,c.command,c.machine,c.lockwait from all_objects a,v$locked_object b,v$session c where a.object_id=b.object_id and c.sid=b.session_id;</span><br><span class="line"></span><br><span class="line">OBJECT_NAME       SESSION_ID    SERIAL<span class="comment"># A     PROGRAM      USERNAME COMMAND MACHINE LOCKWAIT</span></span><br><span class="line">T1      208 2941 <span class="keyword">alter</span> <span class="keyword">system</span> <span class="keyword">kill</span> <span class="keyword">session</span> <span class="string">'208,2941'</span>;	     sqlplus@dax-mysql-slave (TNS V1-V3)	      SYS				      0 dax-mysql-slave</span><br><span class="line">T1				      301	 957 <span class="keyword">alter</span> <span class="keyword">system</span> <span class="keyword">kill</span> <span class="keyword">session</span> <span class="string">'301,957'</span>;									     sqlplus@dax-mysql-slave (TNS V1-V3)	      SCOTT				      6 dax-mysql-slave</span><br></pre></td></tr></table></figure>
<p>查看被锁的对象</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> l.session_id <span class="keyword">sid</span>,s.serial<span class="comment">#,l.locked_mode ,l.oracle_username ,l.os_user_name ,s.machine,s.terminal,o.object_name,s.logon_time,c.sql_text FROM v$locked_object l, all_objects o, v$session s, v$sqlarea c WHERE l.object_id = o.object_id AND l.session_id = s.sid and s.sql_id = c.sql_id ORDER BY sid,s.serial#;</span></span><br><span class="line"><span class="keyword">SID</span>    <span class="built_in">SERIAL</span><span class="comment">#     锁模式 登录用户                       登录机器用户名                 机器名                                                           终端用户名                     被锁对象名                     登录数据库时间   会话正在执行的SQL语句    </span></span><br><span class="line"> <span class="number">301</span>	  <span class="number">957</span>	       <span class="number">3</span> SCOTT				<span class="keyword">oracle</span>		       dax-mysql-<span class="keyword">slave</span>							pts/<span class="number">2</span>	       T1			      <span class="number">2019</span>:<span class="number">02</span>:<span class="number">28</span> <span class="number">19</span>:<span class="number">18</span>:<span class="number">06</span></span><br><span class="line"><span class="keyword">update</span> t1 <span class="keyword">set</span> empno=<span class="number">8000</span> <span class="keyword">where</span> empno=<span class="number">7566</span></span><br></pre></td></tr></table></figure>
<p>查询结果如上所示，因为session1的查询已经结束，session2的sql还被锁住，只能查询到session2的sql语句，因此我们要杀掉sessoin1的会话，让session2继续正常运行。如果杀掉了sesison2，其他会话再进来执行dml变更操作，会话仍然被卡主。</p>
<p>实验2：<br>rollback回滚上面的操作，之后继续实验2</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">session2：</span><br><span class="line">20:13:00 SCOTT@ boston&gt; update t1 set empno=8000 where empno=7566;</span><br><span class="line">4097 rows updated.</span><br><span class="line">Elapsed: 00:00:00.09</span><br><span class="line"></span><br><span class="line">session1：</span><br><span class="line">20:14:13 SYS@ boston&gt; select * from scott.t1 for update;</span><br></pre></td></tr></table></figure>
<p>session1执行select操作被卡主<br>session3查看被锁的语句</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">20:10:44 SYS@ boston&gt; select a.object_name,b.session_id,c.serial#,'alter system kill session '''||b.session_id||','||c.serial#||'''; ' as a,c.program,c.username,c.command,c.machine,c.lockwait from all_objects a,v$locked_object b,v$session c where a.object_id=b.object_id and c.sid=b.session_id; </span><br><span class="line"></span><br><span class="line">OBJECT_NAME		       SESSION_ID    SERIAL<span class="comment"># A				     PROGRAM					      USERNAME			COMMAND MACHINE 							 LOCKWAIT</span></span><br><span class="line"><span class="comment">------------------------------ ---------- ---------- --------------------------------------------------------------------------------------------------------------- ------------------------------------------------ ------------------------------ ---------- ---------------------------------------------------------------- ----------------</span></span><br><span class="line">T1				      107	6131 <span class="keyword">alter</span> <span class="keyword">system</span> <span class="keyword">kill</span> <span class="keyword">session</span> <span class="string">'107,6131'</span>;									     sqlplus@dax-mysql-slave (TNS V1-V3)	      SYS				      3 dax-mysql-slave 						 00000000BD230AE0</span><br><span class="line">T1				      301	 957 <span class="keyword">alter</span> <span class="keyword">system</span> <span class="keyword">kill</span> <span class="keyword">session</span> <span class="string">'301,957'</span>;									     sqlplus@dax-mysql-slave (TNS V1-V3)	      SCOTT				      0 dax-mysql-slave</span><br><span class="line">Elapsed: 00:00:00.02</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">20:16:01 SYS@ boston&gt; SELECT l.session_id sid,  </span><br><span class="line">       s.serial<span class="comment">#,  </span></span><br><span class="line">       l.locked_mode 锁模式,  </span><br><span class="line">       l.oracle_username 登录用户,  </span><br><span class="line">       l.os_user_name 登录机器用户名,  </span><br><span class="line">       s.machine 机器名,  </span><br><span class="line">       s.terminal 终端用户名,  </span><br><span class="line">       o.object_name 被锁对象名,  </span><br><span class="line">       s.logon_time 登录数据库时间 ,</span><br><span class="line">       c.sql_text  会话正在执行的sql语句</span><br><span class="line">FROM v$locked_object l, all_objects o, v$session s ,v$sqlarea c</span><br><span class="line">WHERE l.object_id = o.object_id  </span><br><span class="line">   AND l.session_id = s.sid  </span><br><span class="line">   and s.sql_id = c.sql_id</span><br><span class="line">ORDER BY sid, s.serial<span class="comment">#;</span></span><br><span class="line">       SID    SERIAL<span class="comment">#     锁模式 登录用户                       登录机器用户名                 机器名                                                           终端用户名                     被锁对象名                     登录数据库时间  会话正在执行的SQL语句</span></span><br><span class="line">       107	 6131	       3 SYS				oracle		       dax-mysql-slave							pts/0	       T1			      2019:02:28 20:14:13 <span class="keyword">select</span> * <span class="keyword">from</span> scott.t1 <span class="keyword">for</span> <span class="keyword">update</span></span><br><span class="line">Elapsed: <span class="number">00</span>:<span class="number">00</span>:<span class="number">00.01</span></span><br></pre></td></tr></table></figure>
<p>查询结果为session1的select语句被堵塞，处于正在执行的状态，session2的update语句已经执行完成，需要commit才能把锁释放掉。</p>

      
    </div>
    
  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/oracle/">oracle</a>
    </span>
    

    </div>

    
  </div>
  
    
    <h3 class="article-read"><a href="/2019/09/21/oracle查询被锁的sql语句并解锁/"><span>点击阅读</span></a></h3>
    
  
</article>





  <article class="article-container ">

  
    
    <h3 class="article-title"><a href="/2019/09/21/锁表情况下使用exp和expdp导出问题/"><span>[Oracle] 锁表情况下使用exp和expdp导出</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2019/09/21/锁表情况下使用exp和expdp导出问题/" rel="bookmark">
        <time class="entry-date published" datetime="2019-09-21T09:25:00.000Z">
          2019-09-21
        </time>
      </a>
    </span>
    <br />
    
  </div>


  

  <div class="article-content">
    <div class="entry">
      
          <h1 id="1、共享锁"><a href="#1、共享锁" class="headerlink" title="1、共享锁"></a>1、共享锁</h1><p>lock table test in share mode;<br>exp和expdp均可正常导出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">exp test&#x2F;Test1234 file&#x3D;&#x2F;tmp&#x2F;test2.dmp  tables&#x3D;test</span><br><span class="line">Export: Release 11.2.0.4.0 - Production on Tue Jun 4 15:57:35 2019</span><br><span class="line">Copyright (c) 1982, 2011, Oracle and&#x2F;or its affiliates.  All rights reserved.</span><br><span class="line">Connected to: Oracle Database 11g Enterprise Edition Release 11.2.0.4.0 - 64bit Production</span><br><span class="line">With the Partitioning, OLAP, Data Mining and Real Application Testing options</span><br><span class="line">Export done in ZHS16GBK character set and AL16UTF16 NCHAR character set</span><br><span class="line">About to export specified tables via Conventional Path ...</span><br><span class="line">. . exporting table                           TEST          3 rows exported</span><br><span class="line">Export terminated successfully without warnings.</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[oracle@dax-mysql-slave tmp]$ expdp test&#x2F;Test1234 dumpfile&#x3D;expdp5.test directory&#x3D;exp_data_dir tables&#x3D;test</span><br><span class="line">Export: Release 11.2.0.4.0 - Production on Tue Jun 4 15:59:45 2019</span><br><span class="line">Copyright (c) 1982, 2011, Oracle and&#x2F;or its affiliates.  All rights reserved.</span><br><span class="line">Connected to: Oracle Database 11g Enterprise Edition Release 11.2.0.4.0 - 64bit Production</span><br><span class="line">With the Partitioning, OLAP, Data Mining and Real Application Testing options</span><br><span class="line">Starting &quot;TEST&quot;.&quot;SYS_EXPORT_TABLE_01&quot;: test&#x2F;******** dumpfile&#x3D;expdp5.test directory&#x3D;exp_data_dir tables&#x3D;test</span><br><span class="line">Estimate in progress using BLOCKS method...</span><br><span class="line">Processing object type TABLE_EXPORT&#x2F;TABLE&#x2F;TABLE_DATA</span><br><span class="line">Total estimation using BLOCKS method: 64 KB</span><br><span class="line">Processing object type TABLE_EXPORT&#x2F;TABLE&#x2F;TABLE</span><br><span class="line">Processing object type TABLE_EXPORT&#x2F;TABLE&#x2F;INDEX&#x2F;INDEX</span><br><span class="line">Processing object type TABLE_EXPORT&#x2F;TABLE&#x2F;INDEX&#x2F;STATISTICS&#x2F;INDEX_STATISTICS</span><br><span class="line">Processing object type TABLE_EXPORT&#x2F;TABLE&#x2F;STATISTICS&#x2F;TABLE_STATISTICS</span><br><span class="line">. . exported &quot;TEST&quot;.&quot;TEST&quot;                               5.031 KB       3 rows</span><br><span class="line">Master table &quot;TEST&quot;.&quot;SYS_EXPORT_TABLE_01&quot; successfully loaded&#x2F;unloaded</span><br><span class="line">******************************************************************************</span><br><span class="line">Dump file set for TEST.SYS_EXPORT_TABLE_01 is:</span><br><span class="line">  &#x2F;tmp&#x2F;backup&#x2F;expdp5.test</span><br><span class="line">Job &quot;TEST&quot;.&quot;SYS_EXPORT_TABLE_01&quot; successfully completed at Tue Jun 4 15:59:49 2019 elapsed 0 00:00:03</span><br></pre></td></tr></table></figure>

<h1 id="2、排他锁"><a href="#2、排他锁" class="headerlink" title="2、排他锁"></a>2、排他锁</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">15:58:19 TEST@ boston&gt; lock table test in exclusive mode;</span><br><span class="line">Table(s) Locked.</span><br><span class="line">Elapsed: 00:00:00.00</span><br></pre></td></tr></table></figure>

<p>exp可正常导出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[oracle@dax-mysql-slave tmp]$ exp test&#x2F;Test1234 file&#x3D;&#x2F;tmp&#x2F;test4.dmp  tables&#x3D;test</span><br><span class="line">Export: Release 11.2.0.4.0 - Production on Tue Jun 4 16:00:51 2019</span><br><span class="line">Copyright (c) 1982, 2011, Oracle and&#x2F;or its affiliates.  All rights reserved.</span><br><span class="line">Connected to: Oracle Database 11g Enterprise Edition Release 11.2.0.4.0 - 64bit Production</span><br><span class="line">With the Partitioning, OLAP, Data Mining and Real Application Testing options</span><br><span class="line">Export done in ZHS16GBK character set and AL16UTF16 NCHAR character set</span><br><span class="line">About to export specified tables via Conventional Path ...</span><br><span class="line">. . exporting table                           TEST          3 rows exported</span><br><span class="line">Export terminated successfully without warnings.</span><br></pre></td></tr></table></figure>

<p>expdp导出进程被锁，直到排它锁被释放</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[oracle@dax-mysql-slave tmp]$ expdp test&#x2F;Test1234 dumpfile&#x3D;expdp6.test directory&#x3D;exp_data_dir tables&#x3D;test</span><br><span class="line">Export: Release 11.2.0.4.0 - Production on Tue Jun 4 16:01:30 2019</span><br><span class="line">Copyright (c) 1982, 2011, Oracle and&#x2F;or its affiliates.  All rights reserved.</span><br><span class="line">Connected to: Oracle Database 11g Enterprise Edition Release 11.2.0.4.0 - 64bit Production</span><br><span class="line">With the Partitioning, OLAP, Data Mining and Real Application Testing options</span><br><span class="line">Starting &quot;TEST&quot;.&quot;SYS_EXPORT_TABLE_01&quot;:  test&#x2F;******** dumpfile&#x3D;expdp6.test directory&#x3D;exp_data_dir tables&#x3D;test</span><br><span class="line">Estimate in progress using BLOCKS method...</span><br><span class="line">Processing object type TABLE_EXPORT&#x2F;TABLE&#x2F;TABLE_DATA</span><br><span class="line">Total estimation using BLOCKS method: 64 KB</span><br><span class="line">Processing object type TABLE_EXPORT&#x2F;TABLE&#x2F;TABLE</span><br><span class="line">Processing object type TABLE_EXPORT&#x2F;TABLE&#x2F;INDEX&#x2F;INDEX</span><br><span class="line">Processing object type TABLE_EXPORT&#x2F;TABLE&#x2F;INDEX&#x2F;STATISTICS&#x2F;INDEX_STATISTICS</span><br><span class="line">Processing object type TABLE_EXPORT&#x2F;TABLE&#x2F;STATISTICS&#x2F;TABLE_STATISTICS</span><br></pre></td></tr></table></figure>

<p>下面设置当然用户下的表空间为只读</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">16:03:04 TEST@ boston&gt; select default_tablespace from user_users;</span><br><span class="line">DEFAULT_TABLESPACE</span><br><span class="line"><span class="comment">------------------------------</span></span><br><span class="line">USERS</span><br><span class="line">16:03:04 TEST@ boston&gt; alter tablespace users read only;</span><br></pre></td></tr></table></figure>

<p>exp导出正常，expdp报错</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[oracle@dax-mysql-slave tmp]$ exp test&#x2F;Test1234 file&#x3D;&#x2F;tmp&#x2F;test4.dmp  tables&#x3D;test</span><br><span class="line">Export: Release 11.2.0.4.0 - Production on Tue Jun 4 16:04:37 2019</span><br><span class="line">Copyright (c) 1982, 2011, Oracle and&#x2F;or its affiliates.  All rights reserved.</span><br><span class="line">Connected to: Oracle Database 11g Enterprise Edition Release 11.2.0.4.0 - 64bit Production</span><br><span class="line">With the Partitioning, OLAP, Data Mining and Real Application Testing options</span><br><span class="line">Export done in ZHS16GBK character set and AL16UTF16 NCHAR character set</span><br><span class="line">About to export specified tables via Conventional Path ...</span><br><span class="line">. . exporting table                           TEST          3 rows exported</span><br><span class="line">Export terminated successfully without warnings.</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[oracle@dax-mysql-slave tmp]$ expdp test&#x2F;Test1234 dumpfile&#x3D;expdp7.test directory&#x3D;exp_data_dir tables&#x3D;test</span><br><span class="line">Export: Release 11.2.0.4.0 - Production on Tue Jun 4 16:04:42 2019</span><br><span class="line">Copyright (c) 1982, 2011, Oracle and&#x2F;or its affiliates.  All rights reserved.</span><br><span class="line">Connected to: Oracle Database 11g Enterprise Edition Release 11.2.0.4.0 - 64bit Production</span><br><span class="line">With the Partitioning, OLAP, Data Mining and Real Application Testing options</span><br><span class="line">ORA-31626: job does not exist</span><br><span class="line">ORA-31633: unable to create master table &quot;TEST.SYS_EXPORT_TABLE_05&quot;</span><br><span class="line">ORA-06512: at &quot;SYS.DBMS_SYS_ERROR&quot;, line 95</span><br><span class="line">ORA-06512: at &quot;SYS.KUPV$FT&quot;, line 1038</span><br><span class="line">ORA-01647: tablespace &#39;USERS&#39; is read-only, cannot allocate space in it</span><br></pre></td></tr></table></figure>

      
    </div>
    
  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/oracle/">oracle</a>
    </span>
    

    </div>

    
  </div>
  
    
    <h3 class="article-read"><a href="/2019/09/21/锁表情况下使用exp和expdp导出问题/"><span>点击阅读</span></a></h3>
    
  
</article>





  <article class="article-container ">

  
    
    <h3 class="article-title"><a href="/2019/05/27/ORA-00257 archiver error Connect internal only until freed/"><span>[Oracle] ORA-00257: archiver error Connect internal only until freed </span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2019/05/27/ORA-00257 archiver error Connect internal only until freed/" rel="bookmark">
        <time class="entry-date published" datetime="2019-05-27T08:13:00.000Z">
          2019-05-27
        </time>
      </a>
    </span>
    <br />
    
  </div>


  

  <div class="article-content">
    <div class="entry">
      
          <h1 id="1、查看闪回区使用情况"><a href="#1、查看闪回区使用情况" class="headerlink" title="1、查看闪回区使用情况"></a>1、查看闪回区使用情况</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> V$FLASH_RECOVERY_AREA_USAGE;</span><br><span class="line"></span><br><span class="line">FILE_TYPE            PERCENT_SPACE_USED PERCENT_SPACE_RECLAIMABLE NUMBER_OF_FILES</span><br><span class="line"><span class="comment">-------------------- ------------------ ------------------------- ---------------</span></span><br><span class="line">CONTROL FILE                          0                         0               0</span><br><span class="line">REDO LOG                          10.11                         0               2</span><br><span class="line">ARCHIVED LOG                          0                         0               2</span><br><span class="line"><span class="keyword">BACKUP</span> PIECE                          <span class="number">0</span>                         <span class="number">0</span>               <span class="number">0</span></span><br><span class="line">IMAGE COPY                            <span class="number">0</span>                         <span class="number">0</span>               <span class="number">0</span></span><br><span class="line"><span class="keyword">FLASHBACK</span> <span class="keyword">LOG</span>                         <span class="number">0</span>                         <span class="number">0</span>               <span class="number">0</span></span><br><span class="line"><span class="keyword">FOREIGN</span> <span class="keyword">ARCHIVED</span> <span class="keyword">LOG</span>                  <span class="number">0</span>                         <span class="number">0</span>               <span class="number">0</span></span><br></pre></td></tr></table></figure>

<h1 id="2、计算闪回区使用空间"><a href="#2、计算闪回区使用空间" class="headerlink" title="2、计算闪回区使用空间"></a>2、计算闪回区使用空间</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">03:56:25 SYS@ cbi&gt; show parameter recovery;</span><br><span class="line"></span><br><span class="line">NAME                                 TYPE        VALUE</span><br><span class="line"><span class="comment">------------------------------------ ----------- ------------------------------</span></span><br><span class="line">db_recovery_file_dest                string      /u01/app/oracle/fast_recovery_</span><br><span class="line">                                                 area/cbi/</span><br><span class="line">db_recovery_file_dest_size           big integer 10374182400</span><br><span class="line">recovery_parallelism                 integer     0</span><br><span class="line"></span><br><span class="line">N为db_recovery_file_dest_size的大小</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">sum</span>(percent_space_used)*N/<span class="number">100</span> <span class="keyword">from</span> v$flash_recovery_area_usage;</span><br><span class="line"></span><br><span class="line">04:00:43 SYS@ cbi&gt; select sum(percent_space_used)*10/100 from v$flash_recovery_area_usage;</span><br><span class="line"></span><br><span class="line">SUM(PERCENT_SPACE_USED)*10/100</span><br><span class="line"><span class="comment">------------------------------</span></span><br><span class="line">                         1.011</span><br></pre></td></tr></table></figure>

<h1 id="3、ORA-00257的错误是因为归档太多导致闪回区满了造成的，下面通过rman删除归档"><a href="#3、ORA-00257的错误是因为归档太多导致闪回区满了造成的，下面通过rman删除归档" class="headerlink" title="3、ORA-00257的错误是因为归档太多导致闪回区满了造成的，下面通过rman删除归档"></a>3、ORA-00257的错误是因为归档太多导致闪回区满了造成的，下面通过rman删除归档</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">crosscheck archivelog all;</span><br><span class="line">delete archivelog until time &#39;sysdate&#39;; --删除所有日志</span><br><span class="line">delete force noprompt archivelog all completed before &#39;sysdate-3&#39;; --删除3天前的归档</span><br><span class="line">delete expired archivelog all;--删除过期日志</span><br></pre></td></tr></table></figure>
      
    </div>
    
  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/oracle/">oracle</a>
    </span>
    

    </div>

    
  </div>
  
    
    <h3 class="article-read"><a href="/2019/05/27/ORA-00257 archiver error Connect internal only until freed/"><span>点击阅读</span></a></h3>
    
  
</article>





  <article class="article-container ">

  
    
    <h3 class="article-title"><a href="/2019/05/20/linux添加用户sudo使用权限/"><span>[linux] linux添加用户sudo使用权限</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2019/05/20/linux添加用户sudo使用权限/" rel="bookmark">
        <time class="entry-date published" datetime="2019-05-20T08:56:00.000Z">
          2019-05-20
        </time>
      </a>
    </span>
    <br />
    
  </div>


  

  <div class="article-content">
    <div class="entry">
      
          <h1 id="1、修改-etc-sudoers文件"><a href="#1、修改-etc-sudoers文件" class="headerlink" title="1、修改/etc/sudoers文件"></a>1、修改/etc/sudoers文件</h1><p>默认sudoers文件权限为440,需要手动修改权限，否则无法编辑<br><code>chmod 740 /etc/sudoers</code></p>
<p>修改sudoers文件vim /etc/sudoers<br><code>centos  ALL=(ALL)       ALL</code></p>
<p>如果使用sudo的时候不输入密码，需要添加nopasswd参数（注意NOPASSWD: ALL中间有空格）<br><code>centos  ALL=(ALL)       NOPASSWD: ALL</code></p>
<h1 id="2、使用jenkins远程调用shell脚本，执行带有sudo的命令会报错"><a href="#2、使用jenkins远程调用shell脚本，执行带有sudo的命令会报错" class="headerlink" title="2、使用jenkins远程调用shell脚本，执行带有sudo的命令会报错"></a>2、使用jenkins远程调用shell脚本，执行带有sudo的命令会报错</h1><p><code>sudo：抱歉，您必须拥有一个终端来执行 sudo</code></p>
<p>这个问题，需要修改/etc/sudoers配置文件<br><code>Default requiretty</code><br>将Default requiretty这一行注释掉</p>

      
    </div>
    
  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/linux/">linux</a>
    </span>
    

    </div>

    
  </div>
  
    
    <h3 class="article-read"><a href="/2019/05/20/linux添加用户sudo使用权限/"><span>点击阅读</span></a></h3>
    
  
</article>





  <article class="article-container ">

  
    
    <h3 class="article-title"><a href="/2019/05/18/docker启动ssh，允许使用ssh远程登录docker容器/"><span>[linux] docker启动ssh，允许使用ssh远程登录docker容器</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2019/05/18/docker启动ssh，允许使用ssh远程登录docker容器/" rel="bookmark">
        <time class="entry-date published" datetime="2019-05-18T03:34:00.000Z">
          2019-05-18
        </time>
      </a>
    </span>
    <br />
    
  </div>


  

  <div class="article-content">
    <div class="entry">
      
          <h1 id="1、安装依赖包"><a href="#1、安装依赖包" class="headerlink" title="1、安装依赖包"></a>1、安装依赖包</h1><p><code>yum install openssh openssh-server openssh-clients</code></p>
<h1 id="2、修改ssh配置-etc-ssh-ssh-config"><a href="#2、修改ssh配置-etc-ssh-ssh-config" class="headerlink" title="2、修改ssh配置/etc/ssh/ssh_config"></a>2、修改ssh配置/etc/ssh/ssh_config</h1><p>vim /etc/ssh/ssh_config</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#允许root用户ssh登录</span><br><span class="line">PermitRootLogin yes</span><br><span class="line">##禁用PAM</span><br><span class="line">UsePAM no</span><br></pre></td></tr></table></figure>

<h1 id="3、启动ssh服务"><a href="#3、启动ssh服务" class="headerlink" title="3、启动ssh服务"></a>3、启动ssh服务</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">service sshd start</span><br><span class="line">service sshd stop</span><br><span class="line">service sshd restart</span><br></pre></td></tr></table></figure>

<h1 id="4、查看服务是否启动"><a href="#4、查看服务是否启动" class="headerlink" title="4、查看服务是否启动"></a>4、查看服务是否启动</h1><p>netstat -tunlp|grep 22</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      14513&#x2F;sshd</span><br><span class="line">tcp6       0      0 :::22                   :::*                    LISTEN      14513&#x2F;sshd</span><br></pre></td></tr></table></figure>

<h1 id="5、如果启动docker的时候没有指定端口映射，需要重新commit之后，指定新的端口映射启动"><a href="#5、如果启动docker的时候没有指定端口映射，需要重新commit之后，指定新的端口映射启动" class="headerlink" title="5、如果启动docker的时候没有指定端口映射，需要重新commit之后，指定新的端口映射启动"></a>5、如果启动docker的时候没有指定端口映射，需要重新commit之后，指定新的端口映射启动</h1><p><code>docker commit -m=&#39;add sshd service&#39; -a=&#39;zeven&#39; f2622fe8a8d8 zeven/ssh:v1</code></p>
<h1 id="6、重启指定端口映射，启动容器"><a href="#6、重启指定端口映射，启动容器" class="headerlink" title="6、重启指定端口映射，启动容器"></a>6、重启指定端口映射，启动容器</h1><p><code>docker run -dti --privileged -p 2233:22 zeven/ssh:v1  /usr/sbin/init</code></p>
<h1 id="7、启动完成之后可使用ssh连接工具配置宿主机ip、端口2233、用户名、密码便可正常登录docker容器"><a href="#7、启动完成之后可使用ssh连接工具配置宿主机ip、端口2233、用户名、密码便可正常登录docker容器" class="headerlink" title="7、启动完成之后可使用ssh连接工具配置宿主机ip、端口2233、用户名、密码便可正常登录docker容器"></a>7、启动完成之后可使用ssh连接工具配置宿主机ip、端口2233、用户名、密码便可正常登录docker容器</h1>
      
    </div>
    
  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/linux/">linux</a>
    </span>
    

    </div>

    
  </div>
  
    
    <h3 class="article-read"><a href="/2019/05/18/docker启动ssh，允许使用ssh远程登录docker容器/"><span>点击阅读</span></a></h3>
    
  
</article>





  <article class="article-container ">

  
    
    <h3 class="article-title"><a href="/2019/05/09/seeddms部署，docker启动/"><span>[linux] seeddms部署，docker环境启动</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2019/05/09/seeddms部署，docker启动/" rel="bookmark">
        <time class="entry-date published" datetime="2019-05-09T08:44:00.000Z">
          2019-05-09
        </time>
      </a>
    </span>
    <br />
    
  </div>


  

  <div class="article-content">
    <div class="entry">
      
          <h1 id="1、安装基础工具，下载软件安装包"><a href="#1、安装基础工具，下载软件安装包" class="headerlink" title="1、安装基础工具，下载软件安装包"></a>1、安装基础工具，下载软件安装包</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install vim wget gcc net-tools sudo numactl initscripts -y</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p &#x2F;data&#x2F;soft &amp;&amp; cd &#x2F;data&#x2F;soft</span><br><span class="line">wget https:&#x2F;&#x2F;jaist.dl.sourceforge.net&#x2F;project&#x2F;seeddms&#x2F;seeddms-5.1.10&#x2F;seeddms-quickstart-5.1.10.tar.gz</span><br><span class="line">wget https:&#x2F;&#x2F;jaist.dl.sourceforge.net&#x2F;project&#x2F;seeddms&#x2F;seeddms-5.1.10&#x2F;SeedDMS_Core-5.1.10.tgz</span><br><span class="line">wget https:&#x2F;&#x2F;jaist.dl.sourceforge.net&#x2F;project&#x2F;seeddms&#x2F;seeddms-5.1.10&#x2F;SeedDMS_Lucene-1.1.13.tgz</span><br><span class="line">wget https:&#x2F;&#x2F;jaist.dl.sourceforge.net&#x2F;project&#x2F;seeddms&#x2F;seeddms-5.1.10&#x2F;SeedDMS_Preview-1.2.10.tgz</span><br></pre></td></tr></table></figure>

<h1 id="2、解压quickstart安装包"><a href="#2、解压quickstart安装包" class="headerlink" title="2、解压quickstart安装包"></a>2、解压quickstart安装包</h1><p><code>tar -zxvf seeddms-quickstart-5.1.10.tar.gz</code></p>
<h1 id="3、安装php"><a href="#3、安装php" class="headerlink" title="3、安装php"></a>3、安装php</h1><p><code>yum install  php-mysql php-pear php-gd php-http-webdav-server php-mbstring php-pdo php-pear-Log php-ZendFramework-Search-Lucene php-pear-Image-Text php-ZendFramework-Search-Lucene -y</code><br><code>pear install channel://pear.php.net/HTTP_WebDAV_Server-1.0.0RC8</code></p>
<p>php版本要高于,下面升级到5.6，配置5.6yum源<br>追加CentOS 6.5的epel及remi源。<br><code>rpm -Uvh http://ftp.iij.ad.jp/pub/linux/fedora/epel/6/x86_64/epel-release-6-8.noarch.rpm</code><br><code>rpm -Uvh http://rpms.famillecollet.com/enterprise/remi-release-6.rpm</code><br>以下是CentOS 7.0的源。<br><code>yum install epel-release -y</code><br><code>rpm -ivh http://rpms.famillecollet.com/enterprise/remi-release-7.rpm</code><br>使用yum list命令查看可安装的包(Packege)。<br><code>yum list --enablerepo=remi --enablerepo=remi-php56 | grep php</code><br>安装PHP5.6<br>yum源配置好了，下一步就安装PHP5.6。<br><code>yum install --enablerepo=remi --enablerepo=remi-php56 php php-opcache php-devel php-mbstring php-mcrypt php-mysqlnd php-phpunit-PHPUnit php-pecl-xdebug php-pecl-xhprof -y</code><br>用PHP命令查看版本。<br><code>php --version</code></p>
<h1 id="4、安装mysql数据库"><a href="#4、安装mysql数据库" class="headerlink" title="4、安装mysql数据库"></a>4、安装mysql数据库</h1><p>（省略）</p>
<h1 id="5、yum方式安装apache"><a href="#5、yum方式安装apache" class="headerlink" title="5、yum方式安装apache"></a>5、yum方式安装apache</h1><p><code>yum install -y httpd</code><br><code>systemctl enable httpd</code><br><code>systemctl start httpd</code></p>
<h1 id="6、将解压出来的文件拷贝到apache目录下"><a href="#6、将解压出来的文件拷贝到apache目录下" class="headerlink" title="6、将解压出来的文件拷贝到apache目录下"></a>6、将解压出来的文件拷贝到apache目录下</h1><p><code>mkdir –p /var/www/html/dms</code><br><code>mv /data/soft/seeddms51x/* /var/www/html/dms/</code><br><code>chown  apache:apache -R /var/www/html/dms</code><br><code>cd /data/soft</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@node3 soft]# pear install SeedDMS_Core-5.1.10.tgz</span><br><span class="line">install ok: channel://pear.php.net/SeedDMS_Core-5.1.10</span><br><span class="line">[root@node3 soft]# pear install SeedDMS_Lucene-1.1.13.tgz</span><br><span class="line">install ok: channel://pear.php.net/SeedDMS_Lucene-1.1.13</span><br><span class="line">[root@node3 soft]# pear install SeedDMS_Preview-1.2.10.tgz</span><br><span class="line">install ok: channel://pear.php.net/SeedDMS_Preview-1.2.10</span><br></pre></td></tr></table></figure>

<h1 id="7、创建mysql数据库"><a href="#7、创建mysql数据库" class="headerlink" title="7、创建mysql数据库"></a>7、创建mysql数据库</h1><p><code>mysql -u root -p</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">create database db_dms;</span><br><span class="line">grant all privileges on db_dms.* to &#39;dms&#39;@&#39;%&#39; identified  by &#39;dms&#39;;</span><br><span class="line">flush privileges;</span><br><span class="line">source &#x2F;var&#x2F;www&#x2F;html&#x2F;dms&#x2F;seeddms&#x2F;install&#x2F;create_tables-innodb.sql</span><br></pre></td></tr></table></figure>

<h1 id="8、修改php配置文件"><a href="#8、修改php配置文件" class="headerlink" title="8、修改php配置文件"></a>8、修改php配置文件</h1><p>vim /etc/php.ini<br><code>date.timezone = &#39;Asia/Shanghai&#39;</code></p>
<h1 id="9、创建mysql连接"><a href="#9、创建mysql连接" class="headerlink" title="9、创建mysql连接"></a>9、创建mysql连接</h1><p><code>[root@node3 tmp]# mkdir -p /var/lib/mysql/</code><br><code>[root@node3 tmp]# ln -s /data/mysql/tmp/mysql.sock /var/lib/mysql/mysql.sock</code></p>
<h1 id="10、修改配置文件-var-www-html-dms-conf-settings-xml"><a href="#10、修改配置文件-var-www-html-dms-conf-settings-xml" class="headerlink" title="10、修改配置文件/var/www/html/dms/conf/settings.xml"></a>10、修改配置文件/var/www/html/dms/conf/settings.xml</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;server rootDir&#x3D;&quot;&#x2F;var&#x2F;www&#x2F;html&#x2F;dms&#x2F;www&#x2F;&quot; httpRoot&#x3D;&quot;&#x2F;dms&#x2F;seeddms&#x2F;&quot; contentDir&#x3D;&quot;&#x2F;var&#x2F;www&#x2F;html&#x2F;dms&#x2F;data&#x2F;&quot; stagingDir&#x3D;&quot;&#x2F;var&#x2F;www&#x2F;html&#x2F;dms&#x2F;data&#x2F;staging&#x2F;&quot; luceneDir&#x3D;&quot;&#x2F;var&#x2F;www&#x2F;html&#x2F;dms&#x2F;data&#x2F;lucene&#x2F;&quot; logFileEnable&#x3D;&quot;true&quot; logFileRotation&#x3D;&quot;d&quot; enableLargeFileUpload&#x3D;&quot;false&quot; partitionSize&#x3D;&quot;2000000&quot; cacheDir&#x3D;&quot;&#x2F;var&#x2F;www&#x2F;html&#x2F;dms&#x2F;data&#x2F;cache&#x2F;&quot; dropFolderDir&#x3D;&quot;&quot; backupDir&#x3D;&quot;&quot; repositoryUrl&#x3D;&quot;&quot; maxUploadSize&#x3D;&quot;&quot;&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;server coreDir&#x3D;&quot;&quot; luceneClassDir&#x3D;&quot;&quot; contentOffsetDir&#x3D;&quot;1048576&quot; maxDirID&#x3D;&quot;0&quot; updateNotifyTime&#x3D;&quot;86400&quot; extraPath&#x3D;&quot;&#x2F;var&#x2F;www&#x2F;html&#x2F;dms&#x2F;pear&#x2F;&quot; maxExecutionTime&#x3D;&quot;30&quot; cmdTimeout&#x3D;&quot;1&quot;&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;database dbDriver&#x3D;&quot;mysql&quot; dbHostname&#x3D;&quot;localhost&quot; dbDatabase&#x3D;&quot;db_dms&quot; dbUser&#x3D;&quot;dms&quot; dbPass&#x3D;&quot;dms&quot; doNotCheckVersion&#x3D;&quot;false&quot;&gt;</span><br></pre></td></tr></table></figure>

<h1 id="11、下面是本人制作的docker镜像，可下载直接使用"><a href="#11、下面是本人制作的docker镜像，可下载直接使用" class="headerlink" title="11、下面是本人制作的docker镜像，可下载直接使用"></a>11、下面是本人制作的docker镜像，可下载直接使用</h1><p><code>docker run -p 80:80 -dt zeven0707/seeddms:v1  /usr/sbin/init</code><br>(需要加上–privileged，否则启动httpd会报错Failed to get D-Bus connection: Operation not permitted)<br>只后进入docker启动mysql、apache<br><code>/etc/init.d/mysql start</code><br><code>systemctl start httpd</code></p>
<p>启动完成之后，登录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;&lt;宿主机ip&gt;&#x2F;dms&#x2F;seeddms</span><br><span class="line">用户名：admin</span><br><span class="line">密码：admin</span><br></pre></td></tr></table></figure>


      
    </div>
    
  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/linux/">linux</a>
    </span>
    

    </div>

    
  </div>
  
    
    <h3 class="article-read"><a href="/2019/05/09/seeddms部署，docker启动/"><span>点击阅读</span></a></h3>
    
  
</article>





  <article class="article-container ">

  
    
    <h3 class="article-title"><a href="/2019/05/07/修改docker端口映射/"><span>[linux] 修改docker端口映射</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2019/05/07/修改docker端口映射/" rel="bookmark">
        <time class="entry-date published" datetime="2019-05-07T10:37:00.000Z">
          2019-05-07
        </time>
      </a>
    </span>
    <br />
    
  </div>


  

  <div class="article-content">
    <div class="entry">
      
          <p>方法一：<br>1、关闭docker容器<br><code>docker stop 9656305ad917</code><br>2、关闭docker进程<br><code>systemctl stop docker</code><br>3、修改容器对应的配置文件<br><code>cd /var/lib/docker/container/&lt;containid&gt;</code><br><code>vim config.v2.json</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&quot;Config&quot;:&#123;</span><br><span class="line">....</span><br><span class="line">&quot;ExposedPorts&quot;:&#123;&quot;9999&#x2F;tcp&quot;:&#123;&#125;&#125;,</span><br><span class="line">....</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果配置文件中不存在ExposedPorts要自己手动加上,然后修改Ports内容，默认为null<br><code>vim config.v2.json</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;Ports&quot;:&#123;&quot;9999&#x2F;tcp&quot;:[&#123;&quot;HostIp&quot;:&quot;0.0.0.0&quot;,&quot;HostPort&quot;:&quot;9999&quot;&#125;]&#125;</span><br></pre></td></tr></table></figure>

<p>修改hostconfig.json：<br><code>vim hostconfig.json</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;PortBindings&quot;:&#123;&quot;9999&#x2F;tcp&quot;:[&#123;&quot;HostIp&quot;:&quot;&quot;,&quot;HostPort&quot;:&quot;9999&quot;&#125;]&#125;</span><br></pre></td></tr></table></figure>

<p>4、添加完成端口映射之后重启启动docker进程<br><code>systemctl start docker</code><br>5、启动容器<br><code>docker start 9656305ad917</code><br>6、查看容器的端口映射,9999端口映射添加成功</p>
<figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">shell</span><span class="bash"> &gt; docker ps</span></span><br><span class="line">CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS                    NAMES</span><br><span class="line"><span class="number">9656305</span>ad917        centos              <span class="string">"/bin/bash"</span>         <span class="number">28</span> hours ago        Up About an hour    <span class="number">0.0</span>.<span class="number">0.0</span>:<span class="number">9999</span>-&gt;<span class="number">9999</span>/tcp   jenkins</span><br></pre></td></tr></table></figure>

<p>方法二：<br>1、停止容器<br><code>docker stop b693d1c304c5</code><br>2、从容器创建一个新的镜像<br><code>docker commit -m=&quot;install jenkins&quot; -a=&quot;zeven0707&quot; b693d1c304c5 zeven0707/jenkins:v1</code><br>3、启动提交后的镜像，并指定端口<br><code>docker run --name jenkins -p 9999:9999 -td zeven0707/jenkins:v1</code></p>

      
    </div>
    
  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/docker/">docker</a>
    </span>
    

    </div>

    
  </div>
  
    
    <h3 class="article-read"><a href="/2019/05/07/修改docker端口映射/"><span>点击阅读</span></a></h3>
    
  
</article>






<nav class="pagination">
  
  <a href="/page/4/" class="pagination-prev">上一页</a>
  
  
  <a href="/page/6/" class="pagination-next">下一页</a>
  
</nav>
            </main>
            <div class="sidebar
                    col-lg-3 col-lg-offset-0
                    col-md-3 col-md-offset-0
                    col-sm-12
                    col-xs-12
                    sidebar-container
                ">

                <div class="sidebar-container">



<div class="search-container">
<form class="site-search-form">
    <span class="glyphicon glyphicon-search"></span><input type="text" id="local-search-input" class="st-search-input" placeholder="Search..." />
</form>
<div id="local-search-result" class="local-search-result-cls"></div>
</div>
<script type="text/javascript" id="local.search.active">
var inputArea       = document.querySelector("#local-search-input");
inputArea.onclick   = function(){ getSearchFile(); this.onclick = null }
inputArea.onkeydown = function(){ if(event.keyCode == 13) return false }
</script>




    <div class="categories-container" style="margin-top:40px;">
        <p>归档:</p>
            
    </div>




    <div class="social-container" style="margin-top:40px;">
        <p>Links:</p>
            
                
                    <li class="social-item"><i class="fa fa-fw fa-github"></i><a href="https://github.com/zeven0707">GitHub</a></li>
                
            
    </div>

</div>
            </div>
          </div>
        </div>
        
    <footer class="site-footer">
  <p class="site-info">
    Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and
    Theme by <a href="https://github.com/BosenY/Lap" target="_blank">Lap</a>
    <br/><span id="busuanzi_container_site_uv"> 
  本站访客数<span id="busuanzi_value_site_uv"></span>人次
</span>
    </br>
    
      
        &copy; 2020 zeven0707&#39;s blog
      
    
  </p>
</footer>
    
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-92842840-1', 'auto');
    ga('send', 'pageview');

</script>


  </div>

</div>
<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script src="https://cdn.bootcss.com/vue/2.5.13/vue.min.js"></script>
<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

  <script src="https://unpkg.com/draw-something/dist/draw.min.js"></script>
  <script>
    let maxNum = Number.parseInt('30')
    let iconText = '❤'
    let color = 'red'
    new Draw({maxNum, iconText, color})
  </script>

<script src="/js/index.js"></script>
<script src="/js/search.js"></script>

</body>
</html>